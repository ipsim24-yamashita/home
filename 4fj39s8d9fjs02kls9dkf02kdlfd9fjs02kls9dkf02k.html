<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta
      name="description"
      content="生徒の能力と自主性を最大限に発揮させる塾 ipsim"
    />
    <meta name="color-scheme" content="light dark" />
    <meta name="theme-color" content="#0ea5e9" />

    <!-- Open Graph / Twitter -->
    <meta property="og:type" content="website" />
    <meta property="og:title" content="個別進学塾 ipsim | 山下教室" />
    <meta
      property="og:description"
      content="生徒の能力と自主性を最大限に発揮させる塾 ipsim"
    />
    <meta
      property="og:image"
      content="https://images.unsplash.com/photo-1501785888041-af3ef285b470?q=80&w=1200&auto=format&fit=crop"
    />
    <meta property="og:locale" content="ja_JP" />
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="robots" content="noindex, nofollow" />
    <meta name="googlebot" content="noindex, nofollow" />

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;500;700&family=Poppins:wght@400;600&display=swap"
      rel="stylesheet"
    />

    <title>ipsim | リンク</title>

    <!-- 外部CSS -->
    <link rel="stylesheet" href="./css/styles.css" />
  </head>

  <body>
    <a href="#main" class="skip-link">本文へスキップ</a>

    <header>
      <div class="container nav">
        <a class="brand" aria-label="トップへ戻る">
          <span class="logo" aria-hidden="true"></span>
          <span>ipsim 山下教室</span>
        </a>
        <!-- 必要ならナビを後で追加 -->
      </div>
    </header>

    <!-- ヒーロー -->
    <section class="hero" aria-label="印象的な風景">
      <img
        class="hero__bg"
        src="https://images.unsplash.com/photo-1501785888041-af3ef285b470?q=80&w=2000&auto=format&fit=crop"
        alt="美しい風景（山と湖）"
      />
      <div class="container">
        <h1>ipsim</h1>
        <p class="sub">
          <span class="u-chip">ここから始まるあなたの物語</span>
        </p>
        <span class="eyebrow">今日からでも遅くない</span>
        <span class="eyebrow">明日からではもう遅い</span>
        <span class="eyebrow">いまこの瞬間に全力を注げ！</span>
        <div class="hero-actions">
          <a class="btn btn-primary" href="https://www14.assist-web.jp/ipsim/"
            >Assist</a
          >
          <a
            class="btn btn-primary"
            href="https://capricious-chinchilla-c87.notion.site/25e9fb38aff78139b4f7ef42a57d0123?pvs=105"
            >時間</a
          >
          <a
            class="btn btn-primary"
            href="https://capricious-chinchilla-c87.notion.site/25f9fb38aff7815c8735cdf849c54eca?pvs=105"
            >内容</a
          >
          <a
            class="btn btn-primary"
            href="https://drive.google.com/drive/folders/153wFc-PrEnIIlIFbwwskTwes_qah87EZ"
            >Drive</a
          >
        </div>
      </div>
    </section>

    <main id="main">
      <!-- 進行中 -->
      <section class="container reveal" aria-labelledby="ongoing-title">
        <h4 id="ongoing-title" class="section-title">進行中のイベント</h4>
        <p class="section-lead">・・・</p>
        <div class="grid grid-3" id="ongoing"></div>
      </section>

      <!-- 終了 -->
      <section class="container reveal" aria-labelledby="ended-title">
        <h4 id="ended-title" class="section-title">終了したイベント</h4>
        <p class="section-lead">・・・</p>
        <div class="grid grid-3" id="ended"></div>
      </section>

      <!-- 未来 -->
      <section class="container reveal" aria-labelledby="future-title">
        <h4 id="future-title" class="section-title">未来のイベント</h4>
        <p class="section-lead">・・・</p>
        <div class="grid grid-3" id="future"></div>
      </section>

      <!-- 成績報告 -->
      <section id="成績報告" class="cta reveal" aria-labelledby="score-title">
        <div class="container">
          <h2 id="score-title" class="section-title">成績を報告してください</h2>
          <p class="section-lead">学校から配布されたらすぐに入力しましょう</p>
          <div class="hero-actions">
            <a
              class="btn btn-primary"
              href="https://capricious-chinchilla-c87.notion.site/1639fb38aff780f08c49dfd17183308c"
              aria-label="成績入力 定期テスト"
              >定期テスト</a
            >
            <a
              class="btn btn-primary"
              href="https://capricious-chinchilla-c87.notion.site/17a9fb38aff781089095dee832806d38"
              aria-label="成績入力 通知表"
              >通知表</a
            >
          </div>
        </div>
      </section>

      <!-- リンク集 -->
      <section id="report" class="cta">
        <div class="container">
          <h2 class="section-title">リンク集</h2>
          <p class="section-lead">新しい発見をしましょう</p>
          <div class="hero-actions">
            <a class="btn btn-primary" href="./links/links_1_tools.html"
              >勉強ツール</a
            >
            <a class="btn btn-primary" href="./links/links_2_exam.html"
              >入学試験</a
            >
            <a class="btn btn-primary" href="./links/links_3_jhschool.html"
              >中学校</a
            >
            <a class="btn btn-primary" href="./links/links_4_publichshool.html"
              >公立高校</a
            >
            <a class="btn btn-primary" href="./links/links_5_privatehshool.html"
              >私立高校</a
            >
            <a class="btn btn-primary" href="./links/links_6_publicuniv.html"
              >国公立大学</a
            >
            <a class="btn btn-primary" href="./links/links_7_privateuniv.html"
              >私立大学</a
            >
          </div>
        </div>
      </section>

      <!-- Google カレンダー 小中部 -->
      <section
        id="calendar-jh"
        class="container reveal"
        aria-labelledby="schedule"
      >
        <h2 id="schedule" class="section-title">小中部 予定表</h2>
        <div class="calendar-wrapper">
          <iframe
            src="https://calendar.google.com/calendar/embed?src=a61c440d8749cf206d438d081296271146e72db0508e9496451028fc6f77e4db%40group.calendar.google.com&ctz=Asia%2FTokyo"
            style="border: 0"
            frameborder="0"
            scrolling="no"
          ></iframe>
        </div>
      </section>

      <!-- Google カレンダー 高校部 -->
      <section
        id="calendar-hs"
        class="container reveal"
        aria-labelledby="highschool-schedule"
      >
        <h2 id="highschool-schedule" class="section-title">高校部 予定表</h2>
        <div class="calendar-wrapper">
          <iframe
            src="https://calendar.google.com/calendar/embed?src=f931bc59d19db0dce44357ee10e0bdafac5993cdd1f067eb7b512f5be1236d47%40group.calendar.google.com&ctz=Asia%2FTokyo"
            style="border: 0"
            frameborder="0"
            scrolling="no"
          ></iframe>
        </div>
      </section>

      <!-- 教室画像 -->
      <section
        id="教室画像"
        class="container reveal"
        aria-labelledby="教室画像-title"
      >
        <div class="cols">
          <div class="mock">
            <img
              src="docs/ipsimroom.jpg"
              alt="教室の様子"
              style="width: 100%; height: 100%; object-fit: cover"
            />
          </div>
        </div>
      </section>
    </main>

    <footer>
      <div class="container footer-grid">
        <small
          >© <span id="y"></span> ipsim / OKAMURA Seminar. All rights
          reserved.</small
        >
        <div class="sns" aria-label="ソーシャルリンク">
          <a
            href="https://www.instagram.com/ipsim.17?igsh=enZjZTdnbGVxdWg1&utm_source=qr"
            aria-label="Instagram"
          >
            <svg
              width="20"
              height="20"
              viewBox="0 0 24 24"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
              aria-hidden="true"
            >
              <rect
                x="3"
                y="3"
                width="18"
                height="18"
                rx="5"
                stroke="currentColor"
                stroke-width="2"
              />
              <circle
                cx="12"
                cy="12"
                r="4"
                stroke="currentColor"
                stroke-width="2"
              />
              <circle cx="17.5" cy="6.5" r="1.2" fill="currentColor" />
            </svg>
          </a>
          <a
            href="https://lin.ee/dEPbQPT"
            aria-label="LINE公式アカウント塾生用"
          >
            <svg
              width="20"
              height="20"
              viewBox="0 0 24 24"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
              aria-hidden="true"
            >
              <path
                d="M12 3c5 0 9 3.3 9 7.5S17 18 12 18c-.6 0-1.2 0-1.8-.1L6 21l.8-3.6C5 16.1 3 13.6 3 10.5 3 6.3 7 3 12 3z"
                stroke="currentColor"
                stroke-width="2"
                stroke-linejoin="round"
              />
            </svg>
          </a>
        </div>
      </div>
    </footer>

    <noscript
      >このページのイベント一覧は JavaScript で表示しています。ブラウザの設定で
      JavaScript を有効にしてください。</noscript
    >

    <script>
      // 年表示
      document.getElementById("y").textContent = new Date().getFullYear();

      // --- Utility ---
      const $ = (sel, ctx = document) => ctx.querySelector(sel);
      const el = (tag, props = {}) =>
        Object.assign(document.createElement(tag), props);

      // アイコンSVG
      function iconSVG(name, size = 24) {
        const s = String(size);
        const wrap = (inner) =>
          `<svg width="${s}" height="${s}" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">${inner}</svg>`;
        switch (name) {
          case "ic-lightbulb":
            return wrap(
              `<g transform="translate(12,12)" stroke="currentColor" stroke-width="2" fill="none">
                <!-- 電球本体 -->
                <circle cx="0" cy="-3" r="6"/>
                <!-- 芯（フィラメント） -->
                <path d="M -2 -3 Q 0 -1 2 -3" stroke="currentColor" stroke-width="1.5" fill="none"/>
                <!-- ソケット部分 -->
                <rect x="-3" y="3" width="6" height="5" rx="1.5"/>
                <line x1="-3" y1="8" x2="3" y2="8"/>
                <!-- ひらめきの線 -->
                <line x1="8" y1="-6" x2="12" y2="-8"/>
                <line x1="9" y1="-3" x2="14" y2="-3"/>
                <line x1="8" y1="0" x2="12" y2="2"/>
              </g>`
            );
          case "ic-flower":
            return wrap(
              `<g transform="translate(12,12)" stroke="currentColor" stroke-width="2" fill="none">
                <!-- 花（チューリップの花びら） -->
                <path d="M -6 -2 Q -6 -8 0 -8 Q 6 -8 6 -2 
                        Q 3 -4 0 -1 Q -3 -4 -6 -2 Z" fill="currentColor"/>
                <!-- 茎 -->
                <rect x="-1" y="0" width="2" height="7" fill="currentColor"/>
                <!-- 葉っぱ（左右対称、丸みを強調） -->
                <path d="M -1 4 Q -5 5 -5 8 Q -3 7 -1 7 Z" fill="currentColor"/>
                <path d="M  1 4 Q  5 5  5 8 Q  3 7  1 7 Z" fill="currentColor"/>
              </g>`
            );
          case "ic-lines":
            return wrap(
              `<g transform="translate(12,12) rotate(-45)" stroke="currentColor" stroke-width="2" stroke-linecap="round" fill="none"><line x1="-9" y1="0" x2="9" y2="0"/><line x1="-5.4" y1="-3.94" x2="5.4" y2="-3.94"/><line x1="-5.4" y1="3.94" x2="5.4" y2="3.94"/></g>`
            );
          case "ic-pencil":
            return wrap(
              `<g transform="rotate(135 12 12)" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"><rect x="4" y="9" width="12" height="6" rx="2"/><path d="M16 9l5 3-5 3z"/><rect x="3" y="9" width="2" height="6" rx="1"/><line x1="9" y1="10" x2="9" y2="14"/></g>`
            );
          case "ic-clock":
            return wrap(
              `<circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"/><polyline points="12,6 12,12 16,14" stroke="currentColor" stroke-width="2" fill="none"/>`
            );
          case "ic-sparkles":
            return wrap(
              `<path d="M5 3l1.5 3.5L10 8l-3.5 1.5L5 13l-1.5-3.5L0 8l3.5-1.5L5 3zM19 11l2 5 5 2-5 2-2 5-2-5-5-2 5-2 2-5zM12 1l1 3 3 1-3 1-1 3-1-3-3-1 3-1 1-3z" fill="currentColor"/>`
            );
          case "ic-bed":
            return wrap(
              `<path d="M3 7v13" stroke="currentColor" stroke-width="2"/><path d="M3 17h18" stroke="currentColor" stroke-width="2"/><path d="M21 17v3" stroke="currentColor" stroke-width="2"/><path d="M3 17v3" stroke="currentColor" stroke-width="2"/><circle cx="8" cy="12" r="2" stroke="currentColor" stroke-width="2"/><path d="M3 12h18" stroke="currentColor" stroke-width="2"/><path d="M14 6h3l-3 3h3" stroke="currentColor" stroke-width="2"/><path d="M18 4h2l-2 2h2" stroke="currentColor" stroke-width="2"/>`
            );
          case "ic-music":
            return wrap(
              `<ellipse cx="8.5" cy="17" rx="2.4" ry="1.8" fill="currentColor"/><ellipse cx="15.5" cy="15.6" rx="2.4" ry="1.8" fill="currentColor"/><rect x="10" y="9" width="1" height="8.5" rx="0.9" fill="currentColor"/><rect x="17" y="7" width="1" height="8.5" rx="0.9" fill="currentColor"/><path d="M10 10 L18 8 L18 6 L10 8 Z" fill="currentColor"/>`
            );
          case "ic-book":
            return wrap(
              `<rect x="3" y="4" width="9" height="16" rx="2" stroke="currentColor" stroke-width="2"/><rect x="12" y="4" width="9" height="16" rx="2" stroke="currentColor" stroke-width="2"/><path d="M12 4v16" stroke="currentColor" stroke-width="2"/>`
            );
          default:
            return wrap(
              `<circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"/>`
            );
        }
      }

      // カード生成（ARIAの点なし“意味づけリスト”）
      function renderCard(card) {
        const art = el("article", { className: "card" });
        const iconWrap = el("div", { className: "icon", ariaHidden: "true" });
        iconWrap.innerHTML = iconSVG(card.icon, card.size || 24);
        const h3 = el("h3");
        h3.textContent = card.title;
        art.append(iconWrap, h3);

        // 段落
        if (card.p) {
          const ps = Array.isArray(card.p) ? card.p : [card.p];
          ps.forEach((txt) => {
            const p = el("p");
            p.innerHTML = txt;
            art.append(p);
          });
        }
        // items: 見た目は箇条書き記号なし、スクリーンリーダーにはリスト
        if (card.items && card.items.length) {
          const list = el("div", {
            className: "plain-list",
            role: "list",
            ariaLabel: card.title,
          });
          card.items.forEach((it) => {
            const row = el("div", { className: "plain-row", role: "listitem" });
            row.innerHTML = it;
            list.append(row);
          });
          art.append(list);
        }
        return art;
      }

      function renderAll(data) {
        const mount = (key, id) => {
          const root = document.getElementById(id);
          root.innerHTML = "";
          (data[key] || []).forEach((c) => root.appendChild(renderCard(c)));
        };
        mount("ongoing", "ongoing");
        mount("ended", "ended");
        mount("future", "future");
      }

      // JSONを外部から取得
      fetch("./data.json", { cache: "no-store" })
        .then((r) => r.json())
        .then(renderAll)
        .catch((err) => {
          console.error("データ取得に失敗:", err);
          ["ongoing", "ended", "future"].forEach((id) => {
            const root = document.getElementById(id);
            if (root)
              root.innerHTML =
                '<p class="section-lead">データの読み込みに失敗しました。</p>';
          });
        });

      // スムーススクロール（同一ページ内）
      const toggle = document.querySelector(".menu-toggle");
      const menu = document.getElementById("menu-list");
      document.querySelectorAll('a[href^="#"]').forEach((a) => {
        a.addEventListener("click", (e) => {
          const id = a.getAttribute("href");
          if (id && id.length > 1) {
            e.preventDefault();
            document.querySelector(id)?.scrollIntoView({ behavior: "smooth" });
            menu?.classList.remove("open");
            toggle?.setAttribute("aria-expanded", "false");
          }
        });
      });

      // スクロール時アニメーション
      const io = new IntersectionObserver(
        (entries) =>
          entries.forEach((ent) => {
            if (ent.isIntersecting) {
              ent.target.classList.add("in");
              io.unobserve(ent.target);
            }
          }),
        { threshold: 0.12 }
      );
      document.querySelectorAll(".reveal").forEach((el) => io.observe(el));
    </script>
  </body>
</html>
